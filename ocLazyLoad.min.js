/**
 * original copyright: Andy Grom (https://github.com/AndyGrom/loadOnDemand)
 * rewrite by: Olivier Combe (https://github.com/ocombe/ocLazyLoad)
 */
(function(){"use strict";function n(t){var n=[];angular.forEach(t.requires,function(t){if(e.indexOf(t)===-1){n.push(t)}});return n}function r(e){try{angular.module(e)}catch(t){if(/No module/.test(t)||t.message.indexOf("$injector:nomod")>-1){return false}}return true}function i(t,n,r){if(n){var o,u,a,f,l,c,h,p,d=[];for(a=n.length-1;a>=0;a--){l=n[a];if(typeof l!=="string"){l=s(l)}if(!l||e.indexOf(l)>-1){continue}e.push(l);c=angular.module(l);i(t,c.requires,r);d=d.concat(c._runBlocks);try{for(f=c._invokeQueue,o=0,u=f.length;o<u;o++){h=f[o];if(angular.isArray(h)){if(t.hasOwnProperty(h[0])){p=t[h[0]]}else{return r.error("unsupported provider "+h[0])}p[h[1]].apply(p,h[2])}}}catch(v){if(v.message){v.message+=" from "+l}r.error(v.message);throw v}n.pop()}var m=t.getInstanceInjector();angular.forEach(d,function(e){try{m.invoke(e)}catch(t){if(t.message){t.message+=" from "+l}r.error(t.message)}})}return null}function s(e){return e.name?e.name:null}function o(t){function u(e){return e&&n.push(e)}var n=[t],r,i,s=["ng:app","ng-app","x-ng-app","data-ng-app"],o=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/;angular.forEach(s,function(e){s[e]=true;u(document.getElementById(e));e=e.replace(":","\\:");if(t.querySelectorAll){angular.forEach(t.querySelectorAll("."+e),u);angular.forEach(t.querySelectorAll("."+e+"\\:"),u);angular.forEach(t.querySelectorAll("["+e+"]"),u)}});angular.forEach(n,function(e){if(!r){var n=" "+t.className+" ";var u=o.exec(n);if(u){r=e;i=(u[2]||"").replace(/\s+/g,",")}else{angular.forEach(e.attributes,function(t){if(!r&&s[t.name]){r=e;i=t.value}})}}});if(r){(function a(t){if(e.indexOf(t)===-1){e.push(t);var n=angular.module(t);angular.forEach(n.requires,a)}})(i)}}var e=["ng"];var t=angular.module("oc.lazyLoad",["ng"]);t.provider("$ocLazyLoad",["$controllerProvider","$provide","$compileProvider","$filterProvider","$injector",function(t,s,u,a,f){var l={},c,h=[],p={$controllerProvider:t,$compileProvider:u,$filterProvider:a,$provide:s,$injector:f};this.$get=["$timeout","$log","$q","$templateCache","$http","$rootElement",function(t,s,o,u,a,f){var d;p.getInstanceInjector=function(){return d?d:d=f.data("$injector")};return{getModuleConfig:function(e){if(!l[e]){return null}return l[e]},setModuleConfig:function(e){l[e.name]=e;return e},getModules:function(){return e},getModuleName:function(e){var t;if(typeof e==="string"){t=e}else if(typeof e==="object"&&e.hasOwnProperty("name")&&typeof e.name==="string"){t=e.name}else{t=undefined}return t},loadTemplateFile:function(e,t){if(angular.isString(e)){e=[e]}var n=[];angular.forEach(e,function(e){var r=o.defer();n.push(r.promise);if(h.indexOf(e)===-1||angular.isDefined(t)&&t.cache===false){a.get(e,t).success(function(t){angular.forEach(angular.element(t),function(e){if(e.nodeName==="SCRIPT"&&e.type==="text/ng-template"){u.put(e.id,e.innerHTML)}});h.push(e);r.resolve()}).error(function(t){s.error('Error load template "'+e+'": '+t)})}else{r.resolve()}});return o.all(n)},load:function(e){function v(e){var t,i,a,l=[],h;t=u.getModuleName(e);i=angular.module(t);a=n(i);angular.forEach(a,function(n){var i,a;if(typeof n==="string"){i=u.getModuleConfig(n);if(i===null){f.push(n);return}n=i}if(r(n.name)||f.indexOf(n.name)!==-1){if(typeof e!=="string"){s.warn('Module "',t,'" attempted to redefine configuration for dependency "',n.name,'"\nExisting:',u.getModuleConfig(n.name),"Ignored:",n)}return}else if(typeof n==="object"){u.setModuleConfig(n);f.push(n.name)}if(n.hasOwnProperty("files")&&n.files.length!==0){a=o.defer();if(n.files){l.push(a.promise);c(n.files,function(){v(n).then(function(){a.resolve()})})}}});h=o.defer();o.all(l).then(function(){h.resolve()});return h.promise}var u=this,a=null,f=[],l=o.defer(),h,d;h=u.getModuleName(e);if(r(h)){f.push(h);l.resolve();return l.promise}if(typeof e==="string"){a=u.getModuleConfig(e)}else if(typeof e==="object"){a=u.setModuleConfig(e)}if(a===null){d='Module "'+h+'" is not configured, cannot load.';s.error(d);throw d}f.push=function(e){if(this.indexOf(e)===-1){Array.prototype.push.apply(this,arguments)}};c(a.files,function(){f.push(h);v(h).then(function(){i(p,f,s);t(function(){l.resolve(a)})})});return l.promise}}}];this.config=function(t){if(typeof t.asyncLoader==="undefined"){throw"You need to define an async loader such as requireJS or script.js"}c=t.asyncLoader;o(angular.element(window.document));if(t.loadedModules){var n=function(t){if(e.indexOf(t)<0){e.push(t);angular.forEach(angular.module(t).requires,n)}};angular.forEach(t.loadedModules,n)}if(t.modules){if(angular.isArray(t.modules)){angular.forEach(t.modules,function(e){l[e.name]=e})}else{l[t.modules.name]=t.modules}}}}]);t.directive("ocLazyLoad",["$http","$log","$ocLazyLoad","$compile","$timeout","$templateCache",function(e,t,n,r,i,s){return{link:function(i,o,u){function l(){if(a){a.$destroy();a=null}o.html("")}function c(n,r){var i;if(typeof (i=s.get(n))!=="undefined"){r(i)}else{e.get(n).success(function(e){s.put("view:"+n,e);r(e)}).error(function(e){t.error('Error load template "'+n+'": '+e)})}}var a;var f=i.$eval(u.ocLazyLoad).onload||"";i.$watch(u.ocLazyLoad,function(e){if(e){n.load(e).then(function(e){if(!e.template){return}c(e.template,function(e){a=i.$new();o.html(e);var t=o.contents();var n=r(t);n(a);a.$emit("$includeContentLoaded");a.$eval(f)})})}else{l()}})}}}])})()